<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body>
    <div class="contenido">
        <div class="Lista_Amigos">
            <div *ngFor="let amigos of Friends">
                <button class="botonChat" (click)="openChatUser(amigos.idUser)">
                    <div class="user" *ngIf="amigos.estado == 2">
                        <img class="imagen" src={{amigos.imagen}}>
                        <h4 class="nombre">{{amigos.nick}}</h4>
                        <a class="enviarMensaje" (click)="intercambio(amigos.idUser)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
                                <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                    stroke-width="2">
                                    <path d="M3 18a2 2 0 1 0 4 0a2 2 0 1 0-4 0M17 6a2 2 0 1 0 4 0a2 2 0 1 0-4 0" />
                                    <path
                                        d="M19 8v5a5 5 0 0 1-5 5h-3l3-3m0 6l-3-3m-6-2v-5a5 5 0 0 1 5-5h3l-3-3m0 6l3-3" />
                                </g>
                            </svg>
                        </a>
                    </div>
                    <h6 class="nombreId" *ngIf="amigos.estado == 2">Id: {{amigos.idUser}}</h6>
                </button>
            </div>
            <div class="ProfileUser">
                <div *ngFor="let amigos of User">
                    <div class="user">
                        <img class="imagen" src={{amigos.imagen}}>
                        <h4 class="nombre">{{amigos.nick}}</h4>
                    </div>
                    <h6 class="nombreId">Id: {{amigos.idUser}}</h6>
                </div>
            </div>
        </div>
        <div class="Separador">
            <form class="Buscador" [formGroup]="ContactosForm" (ngSubmit)="getUsers()">
                <input class="buscador-input" formControlName="id" placeholder="Buscar Usuario . . .">
                <button class="enviarSol" type="submit">Enviar Solicitud<div class=""></div></button>
            </form>

            <h2>Solicitudes Pendientes</h2>
            <div>
                <div *ngFor="let request of Requests">
                    <div class="Solicitudes">
                        <div class="userSol" *ngIf="request.estado == 1">
                            <img class="imagen" src={{request.imagen}}>
                            <h4 class="nombre">{{ request.nick }}</h4>
                            <button (click)="acceptar(request.idUser)"><img
                                    src="../../../assets/contactos/check-mark.png" class="check"></button>
                            <button (click)="denegar(request.idUser)"><img src="../../../assets/contactos/cross.png"
                                    class="cross"></button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="chat-container">
                <div *ngFor="let chat of Chat">
                    <div class="message" *ngIf="openChat">
                        <div *ngFor="let mensaje of parseMensajes(chat.mensajes); let i = index"
                            class="message-content">
                            <div class="user-info" *ngIf="mostrarUserInfo(parseMensajes(chat.mensajes), i)">
                                <img class="user-image" [src]="mensaje.imagen">
                                <h4 class="user-name">{{ mensaje.nick }}
                                    <p class="message-time">{{ mostrarDateInfo(mensaje.created_at) }}</p>
                                </h4>
                            </div>
                            <div class="message-info">
                                <p class="message-text">{{ mensaje.mensaje }}</p>
                            </div>
                        </div>
                    </div>

                    <form class="Buscador" [formGroup]="ContactosForm" (ngSubmit)="guardarMensajes(chat.idUser)">
                        <input class="buscador-input" formControlName="texto"
                            placeholder="Enviar mensaje a @{{chat.nick}}">
                        <button class="enviarMensaje" type="submit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 48 48">
                                <g fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="4">
                                    <path d="M43 5L29.7 43l-7.6-17.1L5 18.3z" />
                                    <path stroke-linecap="round" d="M43 5L22.1 25.9" />
                                </g>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</body>